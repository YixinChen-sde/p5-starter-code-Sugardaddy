{% load static %}

<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Input</title>

    <!-- credit to https://github.com/js-cookie/js-cookie for the js cookie api for handling cookies -->
    <script type="text/javascript" src="{% static 'queue_t/vendor/jquery/js.cookie.min.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'queue_t/vendor/bootstrap/css/bootstrap.min.css' %}">
    <script type="text/javascript" src="{% static 'queue_t/vendor/jquery/jquery-3.3.1.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'queue_t/vendor/paper/paper-full.min.js' %}"></script>
    <!-- credit to https://github.com/hodgef/simple-keyboard for the keyboard -->
    <link rel="stylesheet" href="{% static 'queue_t/vendor/simple-keyboard/index.css' %}">
    <script src="{% static 'queue_t/vendor/simple-keyboard/index.js' %}"></script>
    <script type="text/javascript" src="{% static 'queue_t/js/loveReceiver.js' %}"></script>
    <style type="text/css">

      body{
        background-color: #D5E3EA;
      }

        /* custom styles */
        label {
          display: block;
        }
        input {
          border: 1px solid #c4c4c4;
          border-radius: 5px;
          background-color: #fff;
          padding: 3px 5px;
          box-shadow: inset 0 3px 6px rgba(0,0,0,0.1);
          width: 50%;
          height: 3cm;
          font-size: 1.5cm;

        }
        .topbar {
            background-color: #EDEEED;
            overflow: hidden;
            position: fixed;
            top: 0;
            width: 100%;
            }

            .topbar a {
            float: left;
            display: block;
            color: #f2f2f2;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            font-size: 17px;
            }

        #event-name{
            width: 100%;
            height: 3cm;
            overflow: hidden;

            }



     .button-selected {
         background: #ddd;
     }

     .simple-keyboard {
         position: fixed;
         bottom: 13vw;
         height: 44vw;
     }
     .hg-button {
         height: 80px !important;
         font-size: 1.8em;
     }

     .container {
        display: flex;
        flex-wrap: wrap;
        padding: 0px;
    }

    .item{
        margin: 30px;
    }

    .icon{
        width: 10vh;
        height: 10vh;
        padding: 0.5vh;
    }


    .text{
        font-family: Roboto;
        font-style: normal;
        font-weight: normal;
        font-size: 80px;
        line-height: 50px;
        color: #000000;
        text-align: center;
      }

     .selectedIcon {
         background: #ccc;
         border-radius: 10px;
     }

    </style>


</head>
<body>
    <br><br><br><br><br>
    <input type="text" id="event-name" name="event-name" placeholder="Name of the activity..." style="font-size: 1.6cm;"><br>
    <br><br><br>

<div class="simple-keyboard"></div>

    <div class="topbar">
        <a href=""><img src="{% static 'queue_t/img/topBack.png' %}" alt="" style="width: 5vh;"></a>
        <a href="activities" style="padding-left: 0%; padding-top: .7cm;"><p style="color: black; font-size: 1.1cm; padding-left: 0%;">Back</p></a>
        <a href="" style="padding-left: 4cm; padding-top: .7cm;"><p style="color: black; font-size: 1.1cm; padding-left: 0%;">Activities</p></a>
        <a href="activities" style="padding-left: 7.5cm; padding-top: .7cm;"><p style="color: black; font-size: 1.1cm; padding-left: 0%;" id="Done">Done</p></a>
    </div>

    <h1 class="text"> Choose icon</h1>
    </br></br> </br> </br></br>
    <div class="container">
        <img class="item icon" id="1_png" src="{% static 'queue_t/img/Amusement park.png' %}" alt="Example">
        <img class="item icon" id="2_png" src="{% static 'queue_t/img/archery.png' %}" alt="Example">
        <img class="item icon" id="3_png" src="{% static 'queue_t/img/target.png' %}" alt="Example">
        <img class="item icon" id="4_png" src="{% static 'queue_t/img/55.png' %}" alt="Example">
        <img class="item icon" id="5_png" src="{% static 'queue_t/img/66.png' %}" alt="Example">
        <img class="item icon" id="6_png" src="{% static 'queue_t/img/77.png' %}" alt="Example">
        <img class="item icon" id="7_png" src="{% static 'queue_t/img/climbing.png' %}" alt="Example">
        <img class="item icon" id="8_png" src="{% static 'queue_t/img/bakery.png' %}" alt="Example">
        <img class="item icon" id="9_png" src="{% static 'queue_t/img/lineal.png' %}" alt="Example">
        <img class="item icon" id="10_png" src="{% static 'queue_t/img/muffin.png' %}" alt="Example">
        <img class="item icon" id="11_png" src="{% static 'queue_t/img/11.png' %}" alt="Example">
        <img class="item icon" id="12_png" src="{% static 'queue_t/img/22.png' %}" alt="Example">
        <img class="item icon" id="13_png" src="{% static 'queue_t/img/33.png' %}" alt="Example">
        <img class="item icon" id="14_png" src="{% static 'queue_t/img/44.png' %}" alt="Example">
        <img class="item icon" id="15_png" src="{% static 'queue_t/img/bicycle.png' %}" alt="Example">
     </div>


</body>
<script>


 //(drew inspiration from daysinput.html)
function createCookie(name, value) {
     document.cookie = name + "=" + value;
     console.log("document.cookie:  " + document.cookie);
 }

 //(drew inspiration from daysinput.html)
 // function to getcookie(drew inspiration from stackoverflow)
 function getCookie(name) {
     var nameEQ = name + "=";
     var ca = document.cookie.split(';');
     for(var i=0;i < ca.length;i++) {
         var c = ca[i];
         while (c.charAt(0)==' ') c = c.substring(1,c.length);
         if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
     }
     return null;
 }


 //(drew inspiration from daysinput.html)
 //if the user clicked the Done button, save how many days left till the event and the event information
 (function() {

    var path;
         $("#1_png").on("click", function(){
            path = document.getElementById("1_png").src;
            icon_selected(path);
         });

         $("#2_png").on("click", function(){
            path = document.getElementById("2_png").src;
            icon_selected(path);
         });

         $("#3_png").on("click", function(){
            path = document.getElementById("3_png").src;
            icon_selected(path);
         });

         $("#4_png").on("click", function(){
            path = document.getElementById("4_png").src;
            icon_selected(path);
         });

         $("#5_png").on("click", function(){
            path = document.getElementById("5_png").src;
            icon_selected(path);
         });

         $("#6_png").on("click", function(){
            path = document.getElementById("6_png").src;
            icon_selected(path);
         });

         $("#7_png").on("click", function(){
            path = document.getElementById("7_png").src;
            icon_selected(path);
         });

         $("#8_png").on("click", function(){
            path = document.getElementById("8_png").src;
            icon_selected(path);
         });

         $("#9_png").on("click", function(){
            path = document.getElementById("9_png").src;
            icon_selected(path);
         });

         $("#10_png").on("click", function(){
            path = document.getElementById("10_png").src;
            icon_selected(path);
         });

         $("#11_png").on("click", function(){
            path = document.getElementById("11_png").src;
            icon_selected(path);
         });

         $("#12_png").on("click", function(){
            path = document.getElementById("12_png").src;
            icon_selected(path);
         });

         $("#13_png").on("click", function(){
            path = document.getElementById("13_png").src;
            icon_selected(path);
         });

         $("#14_png").on("click", function(){
            path = document.getElementById("14_png").src;
            icon_selected(path);
         });

         $("#15_png").on("click", function(){
            path = document.getElementById("15_png").src;
            icon_selected(path);
         });


 })();

 $(".icon").click(function () {
    $(".icon").removeClass("selectedIcon");
    $(this).addClass("selectedIcon");
 });

function icon_selected(path) {

         $(".simple-keyboard").hide();
         if (getCookie('selected_icons') != null) {
           allEvents = getCookie('selected_icons');
           allEvents = JSON.parse(allEvents);
           console.log(allEvents);
         } else {
           allEvents = [];
         }

           var acvitity_name = document.getElementById('event-name').value;
           allEvents.push(acvitity_name);
           var Json_events = JSON.stringify(allEvents);
           console.log("2: " + Json_events);
           createCookie('selected_icons', Json_events);           //This cookies has all of the activity names
           var activity_location = [];
           activity_location.push(path);
           console.log("img path: " + activity_location)
           var json_info = JSON.stringify(activity_location);
           createCookie(acvitity_name, json_info);            //This cookies has the information of current activities
           sendActivity();

}




 function sendActivity() {
     //send selected_icons cookie
     socket.send("{\"uid\" : " + myUID + ",\"selected_icons\" : " + getCookie('selected_icons') + "}" );
     //send all the things in selected_icons cookies
     let allEvents = JSON.parse(getCookie('selected_icons'));
     let eventData = {};
     for (var i = 0; i < allEvents.length; i += 1){
         var ei = JSON.parse(getCookie(allEvents[i]));
         // socket.send("{\"uid\" : " + myUID + ",\"" +allEvents[i] + "\" : " + ei + "}" );
         eventData[allEvents[i]] = ei;
     }
     socket.send("{\"uid\" : " + myUID + ",\"customActivities\" : " + JSON.stringify(eventData) + "}" );
     // socket.send("{\"uid\" : " + myUID + ",\"events\" : " + getCookie('event_list') + "}" );
 }






 // credit to https://github.com/hodgef/simple-keyboard for the keyboard
 // and inspired by the demo https://hodgef.com/simple-keyboard/getting-started/
 let Keyboard = window.SimpleKeyboard.default;
 let keyboard = new Keyboard({
     onChange: input => onChange(input),
     onKeyPress: button => onKeyPress(button),
     physicalKeyboardHighlight: true
 });
 document.querySelector("#event-name").addEventListener("input", event => {
     keyboard.setInput(event.target.value);
 });

 function onChange(input) {
     document.querySelector("#event-name").value = input;
 }

 function onKeyPress(input) {
     // $(".simple-keyboard").show();
 }
 $(".simple-keyboard").hide();
 $("#event-name").focus(() => {
     if ($(".simple-keyboard").is(":hidden")) {
         $(".simple-keyboard").slideToggle(100, "linear");
     }
 });
 $("#event-name").focusout(() => {
    $(".simple-keyboard").slideToggle(100, "linear");
 });
</script>

</html>
